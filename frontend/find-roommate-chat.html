<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat - RoastMyDorm</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="css/roommate.css">
    <link rel="icon" type="image/x-icon" href="roastmydorm_logo-removebg-preview.png">
    <style>
        /* Creative Chat Theme - Ocean glass + gradients */
        body {
            min-height: 100vh;
            background:
                radial-gradient(1200px 600px at -10% -10%, #c7d2fe55, transparent 50%),
                radial-gradient(1000px 500px at 110% -10%, #a7f3d055, transparent 50%),
                linear-gradient(180deg, #f8fafc 0%, #eef2ff 100%);
        }

        .chat-container {
            background: linear-gradient(180deg, rgba(255,255,255,0.75), rgba(255,255,255,0.6));
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(148,163,184,0.25);
            border-radius: 18px;
            box-shadow: 0 20px 50px rgba(2,6,23,0.12);
            overflow: hidden;
        }

        .chat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 1.25rem;
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            color: #e2e8f0;
            border-bottom: 1px solid rgba(255,255,255,0.08);
            box-shadow: 0 8px 20px rgba(2,6,23,0.25);
        }

        .chat-header-info { display: flex; align-items: center; gap: 0.75rem; }

        .chat-header-photo {
            width: 42px; height: 42px; border-radius: 9999px; object-fit: cover;
            border: 2px solid rgba(255,255,255,0.35);
            box-shadow: 0 6px 14px rgba(15,23,42,0.35);
        }

        .chat-header h2 { color: #ffffff !important; }
        #partner-info { color: #cbd5e1 !important; }

        .btn-primary, .btn-secondary, .btn-send {
            border-radius: 12px;
            font-weight: 700;
            transition: transform .15s ease, box-shadow .15s ease, background .3s ease;
        }
        .btn-primary { background: linear-gradient(135deg, #22d3ee, #0284c7); color: white; border: 0; padding: .7rem 1rem; box-shadow: 0 10px 24px rgba(2,132,199,0.35); }
        .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 16px 36px rgba(2,132,199,0.45); }
        .btn-secondary { background: #e2e8f0; color: #0f172a; border: 0; padding: .7rem 1rem; }
        .btn-send { background: linear-gradient(135deg, #10b981, #059669); color: white; border: 0; padding: .7rem 1rem; }
        .btn-send:hover { transform: translateY(-1px); box-shadow: 0 16px 36px rgba(5,150,105,0.35); }
        .btn-decline { background: linear-gradient(135deg, #ef4444, #dc2626); color: white; border: 0; padding: .7rem 1rem; box-shadow: 0 10px 24px rgba(239,68,68,0.35); border-radius: 12px; font-weight: 700; transition: transform .15s ease, box-shadow .15s ease, background .3s ease; cursor: pointer; }
        .btn-decline:hover { transform: translateY(-1px); box-shadow: 0 16px 36px rgba(239,68,68,0.45); }

        .chat-messages {
            height: min(60vh, 640px);
            overflow: auto;
            padding: 1rem;
            background:
                radial-gradient(600px 300px at 100% 0%, #22d3ee11, transparent 60%),
                radial-gradient(600px 300px at 0% 50%, #a78bfa11, transparent 60%),
                linear-gradient(180deg, rgba(255,255,255,0.65), rgba(248,250,252,0.75));
        }

        /* Custom scrollbar */
        .chat-messages::-webkit-scrollbar { width: 10px; }
        .chat-messages::-webkit-scrollbar-thumb { background: rgba(100,116,139,0.35); border-radius: 999px; border: 2px solid transparent; background-clip: padding-box; }

        .message { display: flex; margin: .5rem 0; }
        .message.own { justify-content: flex-end; }
        .message.other { justify-content: flex-start; }

        .message-bubble {
            max-width: 72%;
            padding: .65rem .8rem .5rem .8rem;
            border-radius: 16px;
            position: relative;
            line-height: 1.4;
            box-shadow: 0 10px 24px rgba(15,23,42,0.12);
        }
        .message.own .message-bubble {
            background: linear-gradient(135deg, #38bdf8, #3b82f6);
            color: white;
            border-bottom-right-radius: 6px;
        }
        .message.other .message-bubble {
            background: rgba(255,255,255,0.9);
            border: 1px solid rgba(148,163,184,0.25);
            color: #0f172a;
            border-bottom-left-radius: 6px;
            backdrop-filter: blur(8px);
        }

        .message-time {
            font-size: .72rem;
            opacity: .85;
            margin-top: .25rem;
            text-align: right;
            color: rgba(226,232,240,0.9);
        }
        .message.other .message-time { color: #64748b; }

        .chat-input-area {
            display: flex; gap: .6rem; align-items: center;
            padding: .75rem; border-top: 1px solid rgba(148,163,184,0.25);
            background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.6));
            backdrop-filter: blur(10px);
        }
        .chat-input {
            flex: 1; padding: .85rem 1rem; border-radius: 14px; border: 2px solid rgba(148,163,184,0.35);
            background: rgba(255,255,255,0.85); outline: none; transition: border-color .2s, box-shadow .2s;
        }
        .chat-input:focus { border-color: #38bdf8; box-shadow: 0 0 0 4px rgba(56,189,248,0.15); }

        /* Modal */
        .modal-overlay { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(2,6,23,0.6); backdrop-filter: blur(6px); }
        .modal { width: min(680px, 92vw); background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.75)); border: 1px solid rgba(148,163,184,0.25); border-radius: 16px; box-shadow: 0 30px 70px rgba(2,6,23,0.35); overflow: hidden; }
        .modal-header { display: flex; align-items: center; justify-content: space-between; padding: 1rem 1.25rem; background: linear-gradient(135deg, #0ea5e9, #6366f1); color: white; }
        .modal-body { padding: 1rem 1.25rem 1.25rem; }
        .safety-alert { background: #f1f5f9; border: 1px dashed #94a3b8; border-radius: 12px; padding: .75rem 1rem; color: #0f172a; }
        .form-group label { display: block; font-weight: 600; color: #0f172a; margin-bottom: .35rem; }
        .form-group input, .form-group textarea { width: 100%; border: 2px solid #e2e8f0; border-radius: 12px; padding: .7rem .9rem; background: white; outline: none; }
        .form-group input:focus, .form-group textarea:focus { border-color: #38bdf8; box-shadow: 0 0 0 4px rgba(56,189,248,0.15); }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .form-actions { display: flex; gap: .5rem; justify-content: flex-end; margin-top: .75rem; }

        /* Responsive */
        @media (max-width: 640px) {
            .chat-messages { height: 56vh; }
            .message-bubble { max-width: 84%; }
            .form-row { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav style="background: white; box-shadow: 0 1px 3px rgba(0,0,0,0.1); padding: 1rem 0;">
        <div style="max-width: 1200px; margin: 0 auto; padding: 0 1rem; display: flex; justify-content: space-between; align-items: center;">
            <a href="index.html" style="display: flex; align-items: center; gap: 0.5rem; text-decoration: none; color: #111827;">
                <div style="width: 32px; height: 32px; background: #2563eb; border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">R</div>
                <span style="font-size: 1.25rem; font-weight: bold;">RoastMyDorm</span>
            </a>
            <a href="find-roommate-matches.html" style="padding: 0.5rem 1rem; background: #f3f4f6; border: 1px solid #d1d5db; border-radius: 0.375rem; text-decoration: none; color: #374151; font-weight: 600;">‚Üê Back to Matches</a>
        </div>
    </nav>

    <div style="max-width: 1000px; margin: 2rem auto; padding: 0 1rem;">
        <!-- Chat Header -->
        <div class="chat-container">
            <div class="chat-header">
                <div class="chat-header-info">
                    <a href="find-roommate-matches.html" style="text-decoration: none; color: #374151; margin-right: 1rem;">‚Üê</a>
                    <img id="partner-photo" src="" alt="Profile" class="chat-header-photo" style="display: none;">
                    <div>
                        <h2 id="partner-name" style="font-size: 1.25rem; font-weight: 600; color: #111827; margin: 0;"></h2>
                        <p id="partner-info" style="font-size: 0.875rem; color: #6b7280; margin: 0;"></p>
                    </div>
                </div>
                <button onclick="openScheduleModal()" class="btn-primary">üìÖ Schedule Meet</button>
            </div>

            <!-- Messages -->
            <div class="chat-messages" id="messages-container">
                <div class="empty-state" style="display: none;" id="no-messages">
                    <p style="color: #6b7280; margin: 2rem 0;">No messages yet. Start the conversation!</p>
                </div>
            </div>

            <!-- Input Area -->
            <div class="chat-input-area">
                <input type="text" id="message-input" class="chat-input" placeholder="Type a message..." onkeypress="handleKeyPress(event)">
                <button onclick="sendMessage()" class="btn-send">Send</button>
            </div>

            <!-- Confirm/Decline Match Buttons -->
            <div style="padding: 1rem; border-top: 1px solid rgba(148,163,184,0.25); background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.6)); backdrop-filter: blur(10px);">
                <div id="match-buttons" style="display: flex; gap: 0.75rem; justify-content: center; flex-wrap: wrap;">
                    <button onclick="confirmMatch()" id="confirm-btn" class="btn-primary">‚úÖ Confirm Roommate Match</button>
                    <button onclick="declineMatch()" id="decline-btn" class="btn-decline">‚ùå Decline Roommate Match</button>
                </div>
                <div id="confirmed-message" style="display: none; padding: 0.75rem; background: linear-gradient(135deg, #d1fae5, #a7f3d0); color: #065f46; border-radius: 0.75rem; text-align: center; font-weight: 600; box-shadow: 0 4px 12px rgba(5,95,70,0.15);">
                    ‚úÖ Roommate Match Confirmed
                </div>
                <div id="declined-message" style="display: none; padding: 0.75rem; background: linear-gradient(135deg, #fee2e2, #fecaca); color: #991b1b; border-radius: 0.75rem; text-align: center; font-weight: 600; box-shadow: 0 4px 12px rgba(153,27,27,0.15);">
                    ‚ùå Roommate Match Declined
                </div>
            </div>
        </div>
    </div>

    <!-- Schedule Meeting Modal -->
    <div id="schedule-modal" class="modal-overlay" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <h2 style="margin: 0;">Schedule a Meeting</h2>
                <button onclick="closeScheduleModal()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer;">√ó</button>
            </div>
            <div class="modal-body">
                <div class="safety-alert">
                    <h4>‚ö†Ô∏è Safety Reminder:</h4>
                    <ul>
                        <li>Always meet in a public place for the first time</li>
                        <li>Tell a friend or family member about your meeting</li>
                        <li>Trust your instincts and prioritize your safety</li>
                        <li>Don't share personal financial information</li>
                    </ul>
                </div>
                <form id="meeting-form" onsubmit="submitMeeting(event)">
                    <div class="form-group">
                        <label>Meeting Type</label>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <label style="padding: 1rem; border: 2px solid #d1d5db; border-radius: 0.5rem; cursor: pointer; text-align: center;">
                                <input type="radio" name="meetingType" value="video" checked style="margin-right: 0.5rem;">
                                üìπ In-App Video Call
                            </label>
                            <label style="padding: 1rem; border: 2px solid #d1d5db; border-radius: 0.5rem; cursor: pointer; text-align: center;">
                                <input type="radio" name="meetingType" value="external" style="margin-right: 0.5rem;">
                                üîó External Link
                            </label>
                        </div>
                    </div>
                    <div class="form-group" id="external-link-group" style="display: none;">
                        <label>Meeting Link (Zoom, Google Meet, etc.)</label>
                        <input type="url" id="meeting-link" placeholder="https://...">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Date</label>
                            <input type="date" id="meeting-date" required>
                        </div>
                        <div class="form-group">
                            <label>Time</label>
                            <input type="time" id="meeting-time" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Additional Notes (Optional)</label>
                        <textarea id="meeting-notes" rows="3"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" onclick="closeScheduleModal()" class="btn-secondary">Cancel</button>
                        <button type="submit" class="btn-primary">Schedule Meeting</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="js/roommate-data.js"></script>
    <script src="js/roommate-chat.js"></script>
</body>
</html>

